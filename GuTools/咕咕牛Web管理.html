<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>咕咕牛图库 - GuTools Web</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/Public.css">
    <link rel="stylesheet" href="css/Home.css">
    <link rel="stylesheet" href="css/Gu_Tools/GuTools_Main.css">
    <link rel="stylesheet" href="css/Gu_Tools/GuTools_Generator.css">
    <link rel="stylesheet" href="css/Gu_Tools/GuTools_Import.css">
    <link rel="stylesheet" href="css/Gu_Tools/GuTools_MD5.css">
    <link rel="stylesheet" href="css/Gu_Tools/GuTools_Sequence.css">
    <link rel="stylesheet" href="css/Gu_Tools/GuTools_JsonCal.css">
    <link rel="stylesheet" href="css/Gu_Tools/GuTools_StockroomGo.css">
    <link rel="stylesheet" href="css/Gu_Tools/GuTools_StorageboxCal.css">
    <link rel="stylesheet" href="css/Gu_Tools/GuTools_FileSize.css">
    <link rel="stylesheet" href="css/Gu_Tools/GuTools_SecondaryTagEditor.css">
    <link rel="stylesheet" href="css/Data_List.css">
    <link rel="stylesheet" href="css/Ban_Management.css">
    <link rel="stylesheet" href="css/Plugin_Gallery.css">
    <link rel="stylesheet" href="css/Community_Gallery.css">
    <link rel="stylesheet" href="css/Advanced_Management.css">
    <link rel="stylesheet" href="css/Other.css">
</head>

<body>
    <div class="slideshow-container">
        <div class="slide"></div>
        <div class="slide"></div>
        <div class="slide"></div>
        <div class="slide"></div>
        <div class="slide"></div>
        <div class="slide"></div>
    </div>

    <div class="container">
        <div class="tab-navigation">
            <img id="app-logo" src="/logo.png" alt="App Logo">
            <button class="tab-button active" data-tab="homePane">🐂</button>
            <button class="tab-button" data-tab="GuTools">咕咕牛专用</button>
            <button class="tab-button" data-tab="dataListPane">云端数据库</button>
            <button class="tab-button" data-tab="banManagementPane">封禁管理</button>
            <button class="tab-button" data-tab="pluginGalleryPane">面板图管理</button>
            <button class="tab-button" data-tab="communityGalleryPane">社区图库</button>
            <button class="tab-button" data-tab="advancedManagementPane" id="advanced-mgmt-button">高级管理</button>
            <div id="navFooterInfo">
                <div id="appVersion">咕咕牛 v?.?.?</div>
                <div id="currentTime">--/--/-- --:--:--</div>
            </div>
        </div>

        <div class="tab-content">
            <div id="homePane" class="tab-pane active">
                <div class="home-pane-layout">
                    <div id="repository-cards-container">
                        <div id="repo-card-1" class="repository-card placeholder">
                            <div class="repo-card-content">
                                <div class="repo-card-header">
                                    <div class="repo-title-group">
                                        <h3 class="repo-card-title">No.1-Repo</h3>
                                        <span class="repo-card-subtitle">主资源</span>
                                    </div>
                                    <div id="repo-status-1" class="repo-card-status">
                                        <span class="status-prefix">节点</span>
                                        <span class="status-value">--</span>
                                    </div>
                                </div>
                                <div class="repo-card-stats">
                                    <div class="stats-top-row">
                                        <div class="stat-item">
                                            <div id="repo-roles-1" class="stat-value">--</div>
                                            <div class="stat-label">角色数</div>
                                        </div>
                                        <div class="stat-item">
                                            <div id="repo-images-1" class="stat-value">--</div>
                                            <div class="stat-label">图片数</div>
                                        </div>
                                    </div>
                                    <div class="size-breakdown-container">
                                        <div class="size-item">
                                            <div id="repo-files-size-1" class="size-value">--.- MB</div>
                                            <div class="size-label">占用空间</div>
                                        </div>
                                        <div class="size-operator">+</div>
                                        <div class="size-item">
                                            <div id="repo-git-size-1" class="size-value">--.- MB</div>
                                            <div class="size-label">GIT空间</div>
                                        </div>
                                        <div class="size-operator">=</div>
                                        <div class="size-item total">
                                            <div id="repo-total-size-1" class="size-value">--.- MB</div>
                                            <div class="size-label">总占用</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="repo-card-footer">
                                    <div class="footer-item">
                                        <span class="footer-label">最后更新:</span>
                                        <span id="repo-last-updated-1" class="footer-value">--/-- --:--</span>
                                    </div>
                                    <div class="footer-item">
                                        <span class="footer-label">SHA:</span>
                                        <span id="repo-sha-1" class="footer-value sha">--------------------</span>
                                    </div>
                                </div>
                            </div>
                            <div class="repo-card-message"></div>
                        </div>
                        <div id="repo-card-2" class="repository-card placeholder">
                            <div class="repo-card-content">
                                <div class="repo-card-header">
                                    <div class="repo-title-group">
                                        <h3 class="repo-card-title">No.2-Repo</h3>
                                        <span class="repo-card-subtitle">原神</span>
                                    </div>
                                    <div id="repo-status-2" class="repo-card-status">
                                        <span class="status-prefix">节点</span>
                                        <span class="status-value">--</span>
                                    </div>
                                </div>
                                <div class="repo-card-stats">
                                    <div class="stats-top-row">
                                        <div class="stat-item">
                                            <div id="repo-roles-2" class="stat-value">--</div>
                                            <div class="stat-label">角色数</div>
                                        </div>
                                        <div class="stat-item">
                                            <div id="repo-images-2" class="stat-value">--</div>
                                            <div class="stat-label">图片数</div>
                                        </div>
                                    </div>
                                    <div class="size-breakdown-container">
                                        <div class="size-item">
                                            <div id="repo-files-size-2" class="size-value">--.- MB</div>
                                            <div class="size-label">占用空间</div>
                                        </div>
                                        <div class="size-operator">+</div>
                                        <div class="size-item">
                                            <div id="repo-git-size-2" class="size-value">--.- MB</div>
                                            <div class="size-label">GIT空间</div>
                                        </div>
                                        <div class="size-operator">=</div>
                                        <div class="size-item total">
                                            <div id="repo-total-size-2" class="size-value">--.- MB</div>
                                            <div class="size-label">总占用</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="repo-card-footer">
                                    <div class="footer-item">
                                        <span class="footer-label">最后更新:</span>
                                        <span id="repo-last-updated-2" class="footer-value">--/-- --:--</span>
                                    </div>
                                    <div class="footer-item">
                                        <span class="footer-label">SHA:</span>
                                        <span id="repo-sha-2" class="footer-value sha">--------------------</span>
                                    </div>
                                </div>
                            </div>
                            <div class="repo-card-message"></div>
                        </div>
                        <div id="repo-card-3" class="repository-card placeholder">
                            <div class="repo-card-content">
                                <div class="repo-card-header">
                                    <div class="repo-title-group">
                                        <h3 class="repo-card-title">No.3-Repo</h3>
                                        <span class="repo-card-subtitle">崩坏：星穹铁道</span>
                                    </div>
                                    <div id="repo-status-3" class="repo-card-status">
                                        <span class="status-prefix">节点</span>
                                        <span class="status-value">--</span>
                                    </div>
                                </div>
                                <div class="repo-card-stats">
                                    <div class="stats-top-row">
                                        <div class="stat-item">
                                            <div id="repo-roles-3" class="stat-value">--</div>
                                            <div class="stat-label">角色数</div>
                                        </div>
                                        <div class="stat-item">
                                            <div id="repo-images-3" class="stat-value">--</div>
                                            <div class="stat-label">图片数</div>
                                        </div>
                                    </div>
                                    <div class="size-breakdown-container">
                                        <div class="size-item">
                                            <div id="repo-files-size-3" class="size-value">--.- MB</div>
                                            <div class="size-label">占用空间</div>
                                        </div>
                                        <div class="size-operator">+</div>
                                        <div class="size-item">
                                            <div id="repo-git-size-3" class="size-value">--.- MB</div>
                                            <div class="size-label">GIT空间</div>
                                        </div>
                                        <div class="size-operator">=</div>
                                        <div class="size-item total">
                                            <div id="repo-total-size-3" class="size-value">--.- MB</div>
                                            <div class="size-label">总占用</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="repo-card-footer">
                                    <div class="footer-item">
                                        <span class="footer-label">最后更新:</span>
                                        <span id="repo-last-updated-3" class="footer-value">--/-- --:--</span>
                                    </div>
                                    <div class="footer-item">
                                        <span class="footer-label">SHA:</span>
                                        <span id="repo-sha-3" class="footer-value sha">--------------------</span>
                                    </div>
                                </div>
                            </div>
                            <div class="repo-card-message"></div>
                        </div>
                        <div id="repo-card-4" class="repository-card placeholder">
                            <div class="repo-card-content">
                                <div class="repo-card-header">
                                    <div class="repo-title-group">
                                        <h3 class="repo-card-title">NO.4-Repo</h3>
                                        <span class="repo-card-subtitle">鸣潮&amp;绝区零</span>
                                    </div>
                                    <div id="repo-status-4" class="repo-card-status">
                                        <span class="status-prefix">节点</span>
                                        <span class="status-value">--</span>
                                    </div>
                                </div>
                                <div class="repo-card-stats">
                                    <div class="stats-top-row">
                                        <div class="stat-item">
                                            <div id="repo-roles-4" class="stat-value">--</div>
                                            <div class="stat-label">角色数</div>
                                        </div>
                                        <div class="stat-item">
                                            <div id="repo-images-4" class="stat-value">--</div>
                                            <div class="stat-label">图片数</div>
                                        </div>
                                    </div>
                                    <div class="size-breakdown-container">
                                        <div class="size-item">
                                            <div id="repo-files-size-4" class="size-value">--.- MB</div>
                                            <div class="size-label">占用空间</div>
                                        </div>
                                        <div class="size-operator">+</div>
                                        <div class="size-item">
                                            <div id="repo-git-size-4" class="size-value">--.- MB</div>
                                            <div class="size-label">GIT空间</div>
                                        </div>
                                        <div class="size-operator">=</div>
                                        <div class="size-item total">
                                            <div id="repo-total-size-4" class="size-value">--.- MB</div>
                                            <div class="size-label">总占用</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="repo-card-footer">
                                    <div class="footer-item">
                                        <span class="footer-label">最后更新:</span>
                                        <span id="repo-last-updated-4" class="footer-value">--/-- --:--</span>
                                    </div>
                                    <div class="footer-item">
                                        <span class="footer-label">SHA:</span>
                                        <span id="repo-sha-4" class="footer-value sha">--------------------</span>
                                    </div>
                                </div>
                            </div>
                            <div class="repo-card-message"></div>
                        </div>
                    </div>
                    <div id="settings-cards-container">
                        <div id="tuKuOPStatusNote" class="sticky-note">
                            <div class="sticky-note-title">图库总开关</div>
                            <div class="sticky-note-content">
                                <p id="tuKuOPStatusText">加载中...</p>
                                <label class="switch-large">
                                    <input type="checkbox" id="tuKuOPToggleSwitch">
                                    <span class="slider-large"></span>
                                </label>
                            </div>
                        </div>
                        <div id="pflStatusNote" class="sticky-note">
                            <div class="sticky-note-title">净化等级</div>
                            <div class="sticky-note-content">
                                <p id="pflStatusText">加载中...</p>
                                <div class="tri-state-switch-container">
                                    <input type="radio" id="pflRadio0" name="pflLevel" value="0" class="tri-state-radio"
                                        checked>
                                    <input type="radio" id="pflRadio1" name="pflLevel" value="1"
                                        class="tri-state-radio">
                                    <input type="radio" id="pflRadio2" name="pflLevel" value="2"
                                        class="tri-state-radio">
                                    <div class="tri-state-switch">
                                        <label for="pflRadio0" class="tri-state-label state-0">0</label>
                                        <label for="pflRadio1" class="tri-state-label state-1">Low</label>
                                        <label for="pflRadio2" class="tri-state-label state-2">MAX</label>
                                        <span class="tri-state-slider"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="contentFiltersNote" class="sticky-note">
                            <div class="sticky-note-title">内容过滤</div>
                            <div class="sticky-note-content-vertical">
                                <div class="filter-buttons-container-row">
                                    <button id="ai-filter-btn" class="filter-button">AI 图片</button>
                                    <button id="easteregg-filter-btn" class="filter-button">彩蛋图片</button>
                                </div>
                                <div class="filter-buttons-container-row">
                                    <button id="layout-filter-btn" class="filter-button">全横屏图片</button>
                                </div>
                            </div>
                        </div>
                        <div id="loadModeNote" class="sticky-note">
                            <div class="sticky-note-title">数据流模式</div>
                            <div class="sticky-note-content-vertical">
                                <div class="mode-switch-section">
                                    <p id="executionModeStatusText">加载中...</p>
                                    <label class="switch-large">
                                        <input type="checkbox" id="executionModeToggleSwitch">
                                        <span class="slider-large"></span>
                                    </label>
                                </div>
                                <div id="loadLevelSliderContainer" class="load-level-container disabled">
                                    <div class="load-level-label-group">
                                        <label for="loadLevelSlider">负载等级</label>
                                        <span id="loadLevelValueDisplay">当前: LV.1</span>
                                    </div>
                                    <div class="slider-wrapper">
                                        <span>1</span>
                                        <input type="range" id="loadLevelSlider" class="level-1" min="1" max="3"
                                            step="1" value="1">
                                        <span>3</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="GuTools" class="tab-pane">
                <div id="secondaryTagEditorPaneView" class="gu-tools-view">
                    <div class="gu-tools-title-bar">
                        <div class="gu-tools-mode-buttons">
                            <button data-mode="secondary_tag_editor" class="mode-button active"
                                title="切换到二级标签管理编辑模式">二级标签管理</button>
                            <button data-mode="generator" class="mode-button" title="切换到JSON生成模式">JSON生成</button>
                            <button data-mode="import" class="mode-button" title="切换到图片入库模式">图片入库</button>
                            <button data-mode="md5" class="mode-button" title="切换到MD5校准模式">MD5校准</button>
                            <button data-mode="sequence" class="mode-button" title="切换到序号管理模式">序号管理</button>
                            <button data-mode="json_calibration" class="mode-button" title="切换到JSON校准模式">JSON校准</button>
                            <button data-mode="stockroom_go" class="mode-button" title="切换到仓库转移模式">仓库转移</button>
                            <button data-mode="storagebox_calibration" class="mode-button"
                                title="切换到仓库校准模式">仓库校准</button>
                            <button data-mode="file_size_check" class="mode-button" title="切换到文件占用模式">文件占用</button>
                        </div>
                    </div>
                    <div class="ste-layout-wrapper">
                        <div class="ste-column ste-left-panel">
                            <div id="steThumbnailStripContainer">
                                <div id="steThumbnailStrip"></div>
                            </div>
                            <div id="steMainPreviewContainer">
                                <p id="stePreviewPlaceholder">请选择模式开始</p>
                                <img id="stePreviewImage" src="" alt="当前编辑的图片" class="hidden">
                            </div>
                            <div id="steImageInfo" class="ste-image-info hidden">
                                <div class="info-left-content">
                                    <div class="ste-info-line ste-info-filename" title=""></div>
                                    <div class="ste-info-line ste-info-character"></div>
                                    <div class="ste-info-line ste-info-storagebox"></div>
                                </div>
                                <div id="steCharTagsInteractive" class="info-right-tags">
                                </div>
                            </div>
                        </div>

                        <div class="ste-column ste-right-panel">
                            <div class="ste-controls-bar">
                                <div class="ste-mode-selector">
                                    <input type="radio" name="steMode" value="fill" id="steModeFill" checked>
                                    <label for="steModeFill">补缺模式</label>
                                    <input type="radio" name="steMode" value="all" id="steModeAll">
                                    <label for="steModeAll">全部模式</label>
                                    <div class="slider"></div>
                                </div>
                                <div id="steSearchWrapper" class="ste-search-wrapper">
                                    <input type="search" id="steSearchInput" placeholder="搜索角色/文件名...">
                                    <div id="steSuggestions" class="hidden"></div>
                                </div>
                                <div id="steProgressDisplay" class="ste-progress-display">-/-</div>
                            </div>

                            <div id="steCategorizedTags" class="ste-categorized-tags">
                            </div>

                            <div class="ste-tags-area">
                                <h5 class="ste-area-title">● 当前标签 (可手动输入)</h5>
                                <div id="steManualTags" class="ste-manual-tags-container">
                                    <ul id="steTagList" class="ste-tag-list"></ul>
                                    <input type="text" id="steTagInput" class="ste-tag-input"
                                        placeholder="输入可搜索或创建标签...">
                                    <div id="steTagInputSuggestions" class="ste-suggestions-list hidden"></div>
                                </div>
                            </div>

                            <div class="ste-actions">
                                <button id="steManageTagsBtn" class="tool-button manage-button">标签管理</button>
                                <button id="steSkipButton" class="tool-button abort-button">跳过</button>
                                <button id="steSaveButton" class="tool-button fix-button">保存并下一张</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="generatorPaneView" class="gu-tools-view hidden">
                    <div class="gu-tools-title-bar">
                        <div class="gu-tools-mode-buttons">
                            <button data-mode="secondary_tag_editor" class="mode-button"
                                title="切换到二级标签管理编辑模式">二级标签管理</button>
                            <button data-mode="generator" class="mode-button active" title="切换到JSON生成模式">JSON生成</button>
                            <button data-mode="import" class="mode-button" title="切换到图片入库模式">图片入库</button>
                            <button data-mode="md5" class="mode-button" title="切换到MD5校准模式">MD5校准</button>
                            <button data-mode="sequence" class="mode-button" title="切换到序号管理模式">序号管理</button>
                            <button data-mode="json_calibration" class="mode-button" title="切换到JSON校准模式">JSON校准</button>
                            <button data-mode="stockroom_go" class="mode-button" title="切换到仓库转移模式">仓库转移</button>
                            <button data-mode="storagebox_calibration" class="mode-button"
                                title="切换到仓库校准模式">仓库校准</button>
                            <button data-mode="file_size_check" class="mode-button" title="切换到文件占用模式">文件占用</button>
                        </div>
                    </div>
                    <div class="main-content">
                        <div class="left-panel">
                            <div class="search-wrapper">
                                <label for="searchInput">输入角色名/文件名 (模糊搜索):</label>
                                <input type="text" id="searchInput" autocomplete="off" disabled
                                    placeholder="正在加载图片列表...">
                                <div id="suggestions" class="hidden"></div>
                            </div>
                            <div id="previewArea">
                                <p>图片预览</p>
                                <img id="previewImage" src="" alt="选择的角色图片" class="hidden">
                            </div>
                        </div>
                        <div class="right-panel">
                            <div id="attributesPanel" class="initially-hidden">
                                <h4>图片属性</h4>
                                <div class="attribute-groups-wrapper">
                                    <div class="attribute-group"><label class="group-label">限制级:</label><label><input
                                                type="radio" name="rating" value="none" checked> 无</label><label><input
                                                type="radio" name="rating" value="px18"> Px18</label><label><input
                                                type="radio" name="rating" value="rx18"> Rx18</label></div>
                                    <div class="attribute-group"><label class="group-label">构图:</label><label><input
                                                type="radio" name="layout" value="normal" checked>
                                            人像图</label><label><input type="radio" name="layout" value="fullscreen">
                                            全屏图</label><label><input type="radio" name="layout" value="catcake">
                                            [🐱猫猫糕🐱]</label></div>
                                    <div class="attribute-group"><label class="group-label">特殊:</label><label><input
                                                type="checkbox" id="isEasterEggCheckbox"> 彩蛋</label><label><input
                                                type="checkbox" id="isAiImageCheckbox"> AI图</label></div>
                                </div>
                                <div id="gameTagsContainer"><span id="gameTagGs" class="game-tag">原神</span><span
                                        id="gameTagSr" class="game-tag">星铁</span><span id="gameTagZzz"
                                        class="game-tag">绝区零</span><span id="gameTagWaves" class="game-tag">鸣潮</span>
                                </div>
                                <div id="fileInfoContainer">
                                    <div class="info-group"><label for="md5DisplayInput">MD5:</label><input type="text"
                                            id="md5DisplayInput" readonly placeholder="选择后计算..."></div>
                                    <div class="info-group"><label for="idDisplayInput">GID:</label><input type="text"
                                            id="idDisplayInput" readonly placeholder="选择后生成..."></div>
                                </div>
                                <p id="entryCountDisplay">Json数据量: 0 条</p>
                            </div>
                            <div class="action-area"><button id="saveButton" disabled>保存到 ImageData.json</button>
                                <div id="messageArea"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="importPaneView" class="gu-tools-view hidden">
                    <div class="gu-tools-title-bar">
                        <div class="gu-tools-mode-buttons">
                            <button data-mode="secondary_tag_editor" class="mode-button"
                                title="切换到二级标签管理编辑模式">二级标签管理</button>
                            <button data-mode="generator" class="mode-button" title="切换到JSON生成模式">JSON生成</button>
                            <button data-mode="import" class="mode-button active" title="切换到图片入库模式">图片入库</button>
                            <button data-mode="md5" class="mode-button" title="切换到MD5校准模式">MD5校准</button>
                            <button data-mode="sequence" class="mode-button" title="切换到序号管理模式">序号管理</button>
                            <button data-mode="json_calibration" class="mode-button" title="切换到JSON校准模式">JSON校准</button>
                            <button data-mode="stockroom_go" class="mode-button" title="切换到仓库转移模式">仓库转移</button>
                            <button data-mode="storagebox_calibration" class="mode-button"
                                title="切换到仓库校准模式">仓库校准</button>
                            <button data-mode="file_size_check" class="mode-button" title="切换到文件占用模式">文件占用</button>
                        </div>
                    </div>
                    <div class="import-content-wrapper">
                        <div class="import-left-panel">
                            <div class="form-group"><label for="tempImageSearchInput">搜索待入库图片 (imgtemp 目录):</label>
                                <div class="search-wrapper-import"><input type="text" id="tempImageSearchInput"
                                        autocomplete="off" placeholder="输入文件名搜索...">
                                    <div id="tempImageSuggestions" class="suggestions-import hidden"></div>
                                </div>
                            </div>
                            <div id="tempImagePreviewArea">
                                <p>图片预览</p><img id="tempImagePreview" src="" alt="待入库图片预览" class="hidden">
                            </div>
                        </div>
                        <div class="import-right-panel">
                            <div id="importAttributesPanel">
                                <div class="attribute-groups-wrapper">
                                    <div class="attribute-group"><label class="group-label">限制级:</label><label><input
                                                type="radio" name="importRating" value="none" checked>
                                            无</label><label><input type="radio" name="importRating" value="px18">
                                            Px18</label><label><input type="radio" name="importRating" value="rx18">
                                            Rx18</label></div>
                                    <div class="attribute-group"><label class="group-label">构图:</label><label><input
                                                type="radio" name="importLayout" value="normal" checked>
                                            人像图</label><label><input type="radio" name="importLayout"
                                                value="fullscreen"> 全屏图</label><label><input type="radio"
                                                name="importLayout" value="catcake"> [🐱猫猫糕🐱]</label></div>
                                    <div class="attribute-group"><label class="group-label">特殊:</label><label><input
                                                type="checkbox" id="importIsEasterEggCheckbox"> 彩蛋</label><label><input
                                                type="checkbox" id="importIsAiImageCheckbox"> AI图</label></div>
                                </div>
                            </div>
                            <div class="naming-section">
                                <div class="naming-input-row">
                                    <div class="form-group"><label for="targetFolderSearchInput">搜索或指定目标文件夹:</label>
                                        <div class="search-wrapper-import"><input type="text"
                                                id="targetFolderSearchInput" autocomplete="off"
                                                placeholder="例如: 心海 (可模糊搜索)">
                                            <div id="targetFolderSuggestions" class="suggestions-import hidden"></div>
                                        </div>
                                    </div>
                                    <div class="form-group"><label for="finalFilenameInput">最终文件名 (自动生成):</label>
                                        <div class="filename-input-wrapper"
                                            style="position: relative; display: flex; align-items: center;"><input
                                                type="text" id="finalFilenameInput" placeholder="选择后自动生成..."
                                                readonly><button id="editFilenameButton"
                                                class="edit-filename-btn hidden" title="修改文件名">✏️</button></div>
                                    </div>
                                </div>
                                <div class="form-group" style="margin-top: 15px;"><label
                                        for="importDownloadSourceInput">下载来源 (可选):</label><input type="text"
                                        id="importDownloadSourceInput" placeholder="例如: Pixiv Web"></div>
                            </div>
                            <div class="action-area-import"><button id="addToGalleryButton" class="import-button"
                                    disabled>添加到图库</button>
                                <div id="importMessageArea"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="md5PaneView" class="gu-tools-view hidden">
                    <div class="gu-tools-title-bar">
                        <div class="gu-tools-mode-buttons">
                            <button data-mode="secondary_tag_editor" class="mode-button"
                                title="切换到二级标签管理编辑模式">二级标签管理</button>
                            <button data-mode="generator" class="mode-button" title="切换到JSON生成模式">JSON生成</button>
                            <button data-mode="import" class="mode-button" title="切换到图片入库模式">图片入库</button>
                            <button data-mode="md5" class="mode-button active" title="切换到MD5校准模式">MD5校准</button>
                            <button data-mode="sequence" class="mode-button" title="切换到序号管理模式">序号管理</button>
                            <button data-mode="json_calibration" class="mode-button" title="切换到JSON校准模式">JSON校准</button>
                            <button data-mode="stockroom_go" class="mode-button" title="切换到仓库转移模式">仓库转移</button>
                            <button data-mode="storagebox_calibration" class="mode-button"
                                title="切换到仓库校准模式">仓库校准</button>
                            <button data-mode="file_size_check" class="mode-button" title="切换到文件占用模式">文件占用</button>
                        </div>
                    </div>
                    <div class="tool-content-wrapper md5-layout-wrapper">
                        <div class="md5-column md5-left-column">
                            <h4 class="column-title">JSON 记录列表 (<span id="jsonTotalEntriesDisplay">0</span>)</h4>
                            <div id="jsonMd5ListContainer" class="scrollable-list">
                                <p class="list-placeholder">等待加载 JSON 数据...</p>
                            </div>
                        </div>
                        <div class="md5-column md5-middle-column">
                            <h4 class="column-title">校准控制与状态</h4>
                            <div class="md5-calibration-area">
                                <div class="calibration-controls full-width-buttons"><button id="startMD5Calibration"
                                        class="tool-button">开始校准</button><button id="abortMD5Calibration"
                                        class="tool-button abort-button hidden" disabled>中止校准</button></div>
                                <div id="md5CalibrationStatus" class="calibration-status">
                                    <p>图库文件: <span id="totalFilesChecked">--</span></p>
                                    <p>已检查: <span id="filesCheckedCount">0</span></p>
                                    <p>JSON 记录数: <span id="totalMD5Count">--</span></p>
                                    <p style="color: var(--warning-color);">MD5 不一致: <span
                                            id="mismatchedMD5Count">0</span></p>
                                    <p id="md5CalibrationProgress"
                                        style="font-size: 0.85em; color: var(--secondary-text-color); margin-top: 5px; min-height: 1.2em;">
                                    </p>
                                </div>
                                <progress id="md5CalibrationProgressBar" value="0" max="100"
                                    style="width: 100%; margin-top: 5px; display: none;"></progress>
                                <button id="fixAllMismatchedMD5"
                                    class="tool-button fix-button full-width-button disabled"
                                    title="使用计算出的实际 MD5 更新所有不一致的 JSON 条目">修复所有不一致项</button>
                                <div class="extra-info-area">
                                    <h5 class="extra-info-title">文件存在但 JSON 无记录 (<span
                                            id="filesNotInJsonCount">0</span>)</h5><textarea id="filesNotInJsonList"
                                        class="mismatched-list extra-info-list"
                                        placeholder="文件存在但 JSON 中没有对应记录的文件将显示在此..." readonly></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="md5-column md5-right-column">
                            <h4 class="column-title">不一致列表 (<span id="mismatchedCountDisplay">0</span>)</h4><textarea
                                id="mismatchedMD5List" class="scrollable-list mismatched-list"
                                placeholder="MD5 不一致的文件将显示在此..." readonly></textarea>
                        </div>
                    </div>
                </div>
                <div id="sequencePaneView" class="gu-tools-view hidden">
                    <div class="gu-tools-title-bar">
                        <div class="gu-tools-mode-buttons">
                            <button data-mode="secondary_tag_editor" class="mode-button"
                                title="切换到二级标签管理编辑模式">二级标签管理</button>
                            <button data-mode="generator" class="mode-button" title="切换到JSON生成模式">JSON生成</button>
                            <button data-mode="import" class="mode-button" title="切换到图片入库模式">图片入库</button>
                            <button data-mode="md5" class="mode-button" title="切换到MD5校准模式">MD5校准</button>
                            <button data-mode="sequence" class="mode-button active" title="切换到序号管理模式">序号管理</button>
                            <button data-mode="json_calibration" class="mode-button" title="切换到JSON校准模式">JSON校准</button>
                            <button data-mode="stockroom_go" class="mode-button" title="切换到仓库转移模式">仓库转移</button>
                            <button data-mode="storagebox_calibration" class="mode-button"
                                title="切换到仓库校准模式">仓库校准</button>
                            <button data-mode="file_size_check" class="mode-button" title="切换到文件占用模式">文件占用</button>
                        </div>
                    </div>
                    <div class="tool-content-wrapper sequence-layout-wrapper">
                        <div class="sequence-column sequence-left-column">
                            <h4 class="column-title">扫描与控制</h4>
                            <div class="sequence-controls">
                                <button id="analyzeSequences" class="tool-button">开始扫描所有仓库</button>
                                <div id="sequenceAnalysisStatus" class="analysis-status">
                                    <p>点击按钮开始扫描所有仓库...</p>
                                </div>
                            </div>
                            <button id="fixSequenceIssues" class="tool-button fix-button disabled"
                                title="自动重命名文件以修复序号混乱">一键修复</button>
                        </div>
                        <div class="sequence-column sequence-right-column">
                            <h4 class="column-title">问题列表 & 修复</h4><textarea id="sequenceIssuesList"
                                class="scrollable-list sequence-issues-list" placeholder="序号异常的文件夹及文件将显示在此..."
                                readonly></textarea>
                        </div>
                    </div>
                </div>
                <div id="jsonCalibrationPaneView" class="gu-tools-view hidden">
                    <div class="gu-tools-title-bar">
                        <div class="gu-tools-mode-buttons">
                            <button data-mode="secondary_tag_editor" class="mode-button"
                                title="切换到二级标签管理编辑模式">二级标签管理</button>
                            <button data-mode="generator" class="mode-button" title="切换到JSON生成模式">JSON生成</button>
                            <button data-mode="import" class="mode-button" title="切换到图片入库模式">图片入库</button>
                            <button data-mode="md5" class="mode-button" title="切换到MD5校准模式">MD5校准</button>
                            <button data-mode="sequence" class="mode-button" title="切换到序号管理模式">序号管理</button>
                            <button data-mode="json_calibration" class="mode-button active"
                                title="切换到JSON校准模式">JSON校准</button>
                            <button data-mode="stockroom_go" class="mode-button" title="切换到仓库转移模式">仓库转移</button>
                            <button data-mode="storagebox_calibration" class="mode-button"
                                title="切换到仓库校准模式">仓库校准</button>
                            <button data-mode="file_size_check" class="mode-button" title="切换到文件占用模式">文件占用</button>
                        </div>
                    </div>
                    <div class="tool-content-wrapper json-calibration-layout-wrapper">
                        <div class="json-calibration-column json-calibration-left">
                            <h4 class="column-title">JSON 校准控制</h4>
                            <div class="json-calibration-controls">
                                <button id="startJsonCalibration" class="tool-button">开始 JSON 校准</button>
                                <div id="jsonCalibrationStatus" class="calibration-status">
                                    <p>检查 JSON 条目数: <span id="jsonEntriesCheckedCount">0</span></p>
                                    <p>检查图库文件数: <span id="jsonFilesCheckedCount">--</span></p>
                                    <p style="color: var(--error-color);">缺失文件记录数: <span id="missingFilesCount">0</span>
                                    </p>
                                    <p id="jsonCalibrationProgress"
                                        style="font-size: 0.85em; color: var(--secondary-text-color); margin-top: 5px; min-height: 1.2em;">
                                    </p>
                                </div>
                                <progress id="jsonCalibrationProgressBar" value="0" max="100"
                                    style="width: 100%; margin-top: 10px; display: none;"></progress>
                                <button id="removeMissingEntriesBtn"
                                    class="tool-button fix-button full-width-button disabled"
                                    title="从 ImageData.json 中移除这些文件记录 (高风险!)"
                                    style="background: var(--error-color); border-color: #f87171;">移除缺失记录</button>
                            </div>
                        </div>
                        <div class="json-calibration-column json-calibration-right">
                            <h4 class="column-title">JSON 中存在但文件缺失列表 (<span id="missingFilesCountDisplay">0</span>)</h4>
                            <textarea id="missingFilesList" class="scrollable-list missing-files-list"
                                placeholder="JSON 中记录但实际文件不存在的条目将显示在此..." readonly></textarea>
                        </div>
                    </div>
                </div>
                <div id="stockroomGoPaneView" class="gu-tools-view hidden">
                    <div class="gu-tools-title-bar">
                        <div class="gu-tools-mode-buttons">
                            <button data-mode="secondary_tag_editor" class="mode-button"
                                title="切换到二级标签管理编辑模式">二级标签管理</button>
                            <button data-mode="generator" class="mode-button" title="切换到JSON生成模式">JSON生成</button>
                            <button data-mode="import" class="mode-button" title="切换到图片入库模式">图片入库</button>
                            <button data-mode="md5" class="mode-button" title="切换到MD5校准模式">MD5校准</button>
                            <button data-mode="sequence" class="mode-button" title="切换到序号管理模式">序号管理</button>
                            <button data-mode="json_calibration" class="mode-button" title="切换到JSON校准模式">JSON校准</button>
                            <button data-mode="stockroom_go" class="mode-button active" title="切换到仓库转移模式">仓库转移</button>
                            <button data-mode="storagebox_calibration" class="mode-button"
                                title="切换到仓库校准模式">仓库校准</button>
                            <button data-mode="file_size_check" class="mode-button" title="切换到文件占用模式">文件占用</button>
                        </div>
                    </div>
                    <div class="tool-content-wrapper stockroom-go-layout-wrapper">
                        <div class="stockroom-go-column">
                            <h4 class="column-title">仓库转移控制</h4>
                            <div class="stockroom-go-controls">
                                <div class="form-group">
                                    <label for="sourceStorageBoxSelect">选择源仓库:</label>
                                    <select id="sourceStorageBoxSelect" class="cartoon-select"></select>
                                </div>
                                <div class="form-group">
                                    <label for="sourceFolderSelect">选择源文件夹:</label>
                                    <select id="sourceFolderSelect" class="cartoon-select" disabled>
                                        <option value="">-- 请先选择源仓库 --</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="targetStorageBoxSelectGo">选择目标仓库:</label>
                                    <select id="targetStorageBoxSelectGo" class="cartoon-select" disabled></select>
                                </div>
                                <button id="transferFolderButton" class="tool-button primary full-width-button"
                                    disabled>开始转移</button>
                            </div>
                        </div>
                        <div class="stockroom-go-column stockroom-info-column">
                            <h4 class="column-title">仓库概览</h4>
                            <div id="stockroomInfoContainer" class="scrollable-list stockroom-info-grid">
                                <p class="list-placeholder">正在加载仓库信息...</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="storageboxCalibrationPaneView" class="gu-tools-view hidden">
                    <div class="gu-tools-title-bar">
                        <div class="gu-tools-mode-buttons">
                            <button data-mode="secondary_tag_editor" class="mode-button"
                                title="切换到二级标签管理编辑模式">二级标签管理</button>
                            <button data-mode="generator" class="mode-button" title="切换到JSON生成模式">JSON生成</button>
                            <button data-mode="import" class="mode-button" title="切换到图片入库模式">图片入库</button>
                            <button data-mode="md5" class="mode-button" title="切换到MD5校准模式">MD5校准</button>
                            <button data-mode="sequence" class="mode-button" title="切换到序号管理模式">序号管理</button>
                            <button data-mode="json_calibration" class="mode-button" title="切换到JSON校准模式">JSON校准</button>
                            <button data-mode="stockroom_go" class="mode-button" title="切换到仓库转移模式">仓库转移</button>
                            <button data-mode="storagebox_calibration" class="mode-button active"
                                title="切换到仓库校准模式">仓库校准</button>
                            <button data-mode="file_size_check" class="mode-button" title="切换到文件占用模式">文件占用</button>
                        </div>
                    </div>
                    <div class="sbxcal-layout-wrapper">
                        <div class="sbxcal-column sbxcal-left-column">
                            <h4 class="column-title">仓库校准控制</h4>
                            <div id="sbxCalStatusArea" class="sbxcal-status-area calibration-status">
                                <p>点击“开始校准”以启动。</p>
                                <p class="status-line"><span class="label">JSON记录总数:</span> <span
                                        id="sbxCalTotalJsonDisplay" class="value">0</span></p>
                                <p class="status-line"><span class="label">物理文件总数:</span> <span
                                        id="sbxCalTotalFilesDisplay" class="value">0</span></p>
                                <p class="status-line"><span class="label">已检查JSON:</span> <span
                                        id="sbxCalCheckedJsonDisplay" class="value">0</span></p>
                                <p class="status-line"><span class="label">不一致数量:</span> <span
                                        id="sbxCalMismatchCountDisplay" class="value error">0</span></p>
                                <hr style="border-color: var(--sbx-border-color); margin: 8px 0;">
                                <p id="sbxCalCurrentScanItemLabel"
                                    style="font-weight: bold; color: var(--sbx-text-dark); margin-bottom: 2px;">当前检查:
                                </p>
                                <div id="sbxCalCurrentScanDetails"
                                    style="font-size: 0.85em; line-height: 1.4; color: var(--sbx-text-medium); min-height: 60px; word-break: break-all;">
                                    <p><span class="label">文件名:</span> <span id="sbxCalScanFilename"
                                            class="value">-</span></p>
                                    <p><span class="label">声称仓库:</span> <span id="sbxCalScanJsonBox"
                                            class="value">-</span></p>
                                    <p><span class="label">实际仓库:</span> <span id="sbxCalScanActualBox"
                                            class="value">-</span></p>
                                    <p><span class="label">是否一致:</span> <span id="sbxCalScanMatchStatus"
                                            class="value">-</span></p>
                                </div>
                            </div>
                            <progress id="sbxCalProgressBar" value="0" max="100"
                                style="display: none; width: 100%; margin-top: 10px;"></progress>
                            <div class="sbxcal-controls-buttons"
                                style="margin-top: auto; padding-top:15px; display: flex; flex-direction: column; gap: 10px;">
                                <button id="sbxCalStartButton" class="tool-button">开始校准</button>
                                <button id="sbxCalAbortButton" class="tool-button abort-button hidden"
                                    disabled>中止校准</button>
                                <button id="sbxCalFixButton"
                                    class="tool-button fix-button full-width-button disabled">一键修正不一致项</button>
                            </div>
                        </div>
                        <div class="sbxcal-column sbxcal-right-column">
                            <h4 class="column-title">不一致列表 (<span id="sbxCalMismatchCountDisplayInner">0</span>)</h4>
                            <textarea id="sbxCalMismatchList" class="sbxcal-output-area"
                                placeholder="storagebox与物理位置不符的条目将显示在此..." readonly></textarea>
                        </div>
                    </div>
                </div>
                <div id="fileSizePaneView" class="gu-tools-view hidden">
                    <div class="gu-tools-title-bar">
                        <div class="gu-tools-mode-buttons">
                            <button data-mode="secondary_tag_editor" class="mode-button"
                                title="切换到二级标签管理编辑模式">二级标签管理</button>
                            <button data-mode="generator" class="mode-button" title="切换到JSON生成模式">JSON生成</button>
                            <button data-mode="import" class="mode-button" title="切换到图片入库模式">图片入库</button>
                            <button data-mode="md5" class="mode-button" title="切换到MD5校准模式">MD5校准</button>
                            <button data-mode="sequence" class="mode-button" title="切换到序号管理模式">序号管理</button>
                            <button data-mode="json_calibration" class="mode-button" title="切换到JSON校准模式">JSON校准</button>
                            <button data-mode="stockroom_go" class="mode-button" title="切换到仓库转移模式">仓库转移</button>
                            <button data-mode="storagebox_calibration" class="mode-button"
                                title="切换到仓库校准模式">仓库校准</button>
                            <button data-mode="file_size_check" class="mode-button active"
                                title="切换到文件占用模式">文件占用</button>
                        </div>
                    </div>
                    <div class="tool-content-wrapper fs-layout-wrapper">
                        <div class="fs-column fs-controls-panel">
                            <h4 class="column-title">筛选与控制</h4>
                            <div class="fs-filter-group">
                                <label for="fsGameFilter">按游戏筛选:</label>
                                <select id="fsGameFilter" class="cartoon-select"></select>
                            </div>
                            <div class="fs-filter-group">
                                <label for="fsStorageBoxFilter">按仓库筛选:</label>
                                <select id="fsStorageBoxFilter" class="cartoon-select"></select>
                            </div>
                            <div class="fs-filter-group">
                                <label>按文件占用筛选:</label>
                                <div class="size-input-row">
                                    <input type="number" id="fsMinSizeInput" class="cartoon-input" placeholder="最小"
                                        min="0">
                                    <span>-</span>
                                    <input type="number" id="fsMaxSizeInput" class="cartoon-input" placeholder="最大"
                                        min="0">
                                    <select id="fsUnitSelector" class="cartoon-select">
                                        <option value="KB">KB</option>
                                        <option value="MB" selected>MB</option>
                                    </select>
                                </div>
                            </div>
                            <div id="fsStatusText" class="fs-status-text">等待加载数据...</div>
                            <div class="fs-control-group-buttons">
                                <button id="fsApplyFilterBtn" class="tool-button">应用筛选</button>
                                <button id="fsResetFilterBtn" class="tool-button abort-button">重置所有</button>
                            </div>
                        </div>
                        <div class="fs-column fs-results-container">
                            <h4 class="column-title">文件列表</h4>
                            <div id="fsResultsGrid" class="fs-results-grid">
                                <p class="list-placeholder">点击“应用筛选”按钮开始</p>
                            </div>
                            <div id="fsPaginationControls" class="pagination-controls hidden">
                                <button id="fsPrevPageBtn" class="pagination-btn">
                                    &lt; 上一页</button>
                                <span id="fsPageInfo" class="page-info">第 1 / 1 页</span>
                                <button id="fsNextPageBtn" class="pagination-btn">下一页 &gt;</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="secondaryTagEditorPaneView" class="tab-pane">
                <div class="ste-layout-wrapper">
                    <div class="ste-column ste-left-panel">
                        <div id="steThumbnailStripContainer">
                            <div id="steThumbnailStrip"></div>
                        </div>
                        <div id="steMainPreviewContainer">
                            <p id="stePreviewPlaceholder">请选择模式开始</p>
                            <img id="stePreviewImage" src="" alt="当前编辑的图片" class="hidden">
                        </div>
                        <div id="steImageInfo" class="ste-image-info hidden">
                            <div class="info-left-content">
                                <div class="ste-info-line ste-info-filename" title=""></div>
                                <div class="ste-info-line ste-info-character"></div>
                                <div class="ste-info-line ste-info-storagebox"></div>
                            </div>
                            <div id="steCharTagsInteractive" class="info-right-tags">
                            </div>
                        </div>
                    </div>
                    <div class="ste-column ste-right-panel">
                        <div class="ste-controls-bar">
                            <div class="ste-mode-selector">
                                <input type="radio" name="steMode" value="fill" id="steModeFill" checked>
                                <label for="steModeFill">补缺模式</label>
                                <input type="radio" name="steMode" value="all" id="steModeAll">
                                <label for="steModeAll">全部模式</label>
                                <div class="slider"></div>
                            </div>
                            <div id="steSearchWrapper" class="ste-search-wrapper">
                                <input type="search" id="steSearchInput" placeholder="搜索角色/文件名...">
                                <div id="steSuggestions" class="hidden"></div>
                            </div>
                            <div id="steProgressDisplay" class="ste-progress-display">-/-</div>
                        </div>

                        <div id="steCategorizedTags" class="ste-categorized-tags">
                        </div>

                        <div class="ste-tags-area">
                            <h5 class="ste-area-title">● 当前标签 (可手动输入)</h5>
                            <div id="steManualTags" class="ste-manual-tags-container">
                                <ul id="steTagList" class="ste-tag-list"></ul>
                                <input type="text" id="steTagInput" class="ste-tag-input" placeholder="输入可搜索或创建标签...">
                                <div id="steTagInputSuggestions" class="ste-suggestions-list hidden"></div>
                            </div>
                        </div>

                        <div class="ste-actions">
                            <button id="steManageTagsBtn" class="tool-button manage-button">标签管理</button>
                            <button id="steSkipButton" class="tool-button abort-button">跳过</button>
                            <button id="steSaveButton" class="tool-button fix-button">保存并下一张</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="dataListPane" class="tab-pane">
                <div class="data-list-controls">
                    <div class="top-controls-row">
                        <div class="select-wrapper custom-select-wrapper">
                            <button id="filterGameBtn" class="cartoon-select">——所有游戏——</button>
                            <div id="filterGameDropdown" class="custom-select-dropdown hidden">
                            </div>
                        </div>
                        <div class="search-input-wrapper">
                            <input type="search" id="dataListSearchInput" class="cartoon-input search-input"
                                placeholder=" 搜索角色 / GID / 角色别名 / 二级标签 / 模拼音首字母 / 全拼 / 模糊查找......" autocomplete="off">
                        </div>
                        <div class="select-wrapper secondary-tags-filter-container">
                            <button id="secondaryTagsFilterBtn" class="cartoon-select">二级标签筛选</button>
                            <div id="secondaryTagsDropdown" class="hidden">
                                <div class="tags-dropdown-header">按二级标签筛选</div>
                                <div class="tags-dropdown-content">
                                    <p>正在加载标签...</p>
                                </div>
                                <div class="tags-dropdown-footer">
                                    <button id="clearSecondaryTagsBtn"
                                        class="tool-button-adv abort-button">清空选择</button>
                                </div>
                            </div>
                        </div>
                        <div class="select-wrapper sort-order-filter-container">
                            <button id="sortOrderFilterBtn" class="cartoon-select">默认排序</button>
                            <div id="sortOrderDropdown" class="custom-select-dropdown hidden">
                                <div class="custom-select-option" data-sort-by="default" data-text="默认排序">默认排序</div>
                                <div class="custom-select-option" data-sort-by="size_desc" data-text="从大到小">从大到小</div>
                                <div class="custom-select-option" data-sort-by="size_asc" data-text="从小到大">从小到大</div>
                                <div class="custom-select-option" data-sort-by="date_desc" data-text="最新日期">最新日期</div>
                                <div class="custom-select-option" data-sort-by="date_asc" data-text="历史日期">最早日期</div>
                            </div>
                        </div>
                    </div>
                    <div class="filter-controls">
                        <label class="filter-toggle-label"><input type="checkbox" id="filterPx18"
                                class="filter-toggle-checkbox"><span class="filter-toggle-button" data-on="Px18 开"
                                data-off="Px18 关">Px18 (轻色情)</span></label>
                        <label class="filter-toggle-label"><input type="checkbox" id="filterRx18"
                                class="filter-toggle-checkbox"><span class="filter-toggle-button" data-on="Rx18 开"
                                data-off="Rx18 关">Rx18 (重度色情)</span></label>
                        <label class="filter-toggle-label"><input type="checkbox" id="filterNormal"
                                class="filter-toggle-checkbox"><span class="filter-toggle-button filter-toggle-layout"
                                data-on="人像 开" data-off="人像 关">人像</span></label>
                        <label class="filter-toggle-label"><input type="checkbox" id="filterFullscreen"
                                class="filter-toggle-checkbox"><span class="filter-toggle-button filter-toggle-layout"
                                data-on="全屏 开" data-off="全屏 关">全屏</span></label>
                        <label class="filter-toggle-label"><input type="checkbox" id="filterEasterEgg"
                                class="filter-toggle-checkbox"><span class="filter-toggle-button filter-toggle-special"
                                data-on="彩蛋 开" data-off="彩蛋 关">彩蛋</span></label>
                        <label class="filter-toggle-label"><input type="checkbox" id="filterAiImage"
                                class="filter-toggle-checkbox"><span class="filter-toggle-button filter-toggle-ai"
                                data-on="AI 开" data-off="AI 关">AI 图</span></label>
                        <label class="filter-toggle-label"><input type="checkbox" id="filterisBan"
                                class="filter-toggle-checkbox"><span class="filter-toggle-button filter-toggle-ban"
                                data-on="封禁 开" data-off="封禁 关">封禁中</span></label>
                        <p id="dataListCountDisplay"
                            style="text-align: right; margin: 0 0 0 auto; font-size: 1em;font-weight:700; color: #ffffff; white-space: nowrap;">
                            当前显示: 0 条</p>
                    </div>
                </div>
                <div id="dataListContainer">
                    <p class="no-results" style="display: none;">没有找到匹配的数据。</p>
                    <div id="virtualScrollInner" style="position: relative; width: 100%; height: 0px;">
                        <div id="visibleItemsContainer"
                            style="position: absolute; top: 0px; left: 0px; width: 100%; transform: translateY(0px);">
                        </div>
                    </div>
                </div>
                <!-- <div class="data-list-footer-notice">
                    <p>该页面为咕咕牛图库专用，任何操作均无效。仅用于可视化展示imagedata.json数据。</p>
                </div> -->
            </div>

            <div id="banManagementPane" class="tab-pane">
                <div class="bm-layout-wrapper">
                    <div class="bm-left-column">
                        <div class="bm-panel bm-controls-panel">
                            <h4 class="bm-panel-title">
                                筛选与控制
                            </h4>
                            <div class="bm-controls">
                                <div class="bm-top-controls">
                                    <div class="bm-filter-row">
                                        <div class="select-wrapper custom-select-wrapper">
                                            <button id="bm-filterGameBtn" class="cartoon-select">—所有游戏—</button>
                                            <div id="bm-filterGameDropdown" class="custom-select-dropdown hidden"></div>
                                        </div>
                                        <div class="select-wrapper secondary-tags-filter-container">
                                            <button id="bm-secondaryTagsFilterBtn"
                                                class="cartoon-select">二级标签管理</button>
                                            <div id="bm-secondaryTagsDropdown" class="custom-select-dropdown hidden">
                                                <div class="tags-dropdown-header">按二级标签筛选</div>
                                                <div class="tags-dropdown-content">
                                                    <p>加载中...</p>
                                                </div>
                                                <div class="tags-dropdown-footer">
                                                    <button id="bm-clearSecondaryTagsBtn"
                                                        class="tool-button-adv abort-button">清空选择</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="search-input-wrapper">
                                        <input type="search" id="bm-dataListSearchInput"
                                            class="cartoon-input search-input"
                                            placeholder="搜索角色 / GID / 角色别名 / 二级标签 / 模拼音首字母 / 全拼 / 模糊查找......"
                                            autocomplete="off">
                                    </div>
                                </div>
                                <div class="filter-controls">
                                    <label class="filter-toggle-label"><input type="checkbox" id="bm-filterPx18"
                                            class="filter-toggle-checkbox"><span class="filter-toggle-button"
                                            data-on="Px18 开" data-off="Px18 关">Px18</span></label>
                                    <label class="filter-toggle-label"><input type="checkbox" id="bm-filterRx18"
                                            class="filter-toggle-checkbox"><span class="filter-toggle-button"
                                            data-on="Rx18 开" data-off="Rx18 关">Rx18</span></label>
                                    <label class="filter-toggle-label"><input type="checkbox" id="bm-filterNormal"
                                            class="filter-toggle-checkbox"><span
                                            class="filter-toggle-button filter-toggle-layout" data-on="人像 开"
                                            data-off="人像 关">人像</span></label>
                                    <label class="filter-toggle-label"><input type="checkbox" id="bm-filterFullscreen"
                                            class="filter-toggle-checkbox"><span
                                            class="filter-toggle-button filter-toggle-layout" data-on="全屏 开"
                                            data-off="全屏 关">全屏</span></label>
                                    <label class="filter-toggle-label"><input type="checkbox" id="bm-filterEasterEgg"
                                            class="filter-toggle-checkbox"><span
                                            class="filter-toggle-button filter-toggle-special" data-on="彩蛋 开"
                                            data-off="彩蛋 关">彩蛋</span></label>
                                    <label class="filter-toggle-label"><input type="checkbox" id="bm-filterAiImage"
                                            class="filter-toggle-checkbox"><span
                                            class="filter-toggle-button filter-toggle-ai" data-on="AI 开"
                                            data-off="AI 关">AI图</span></label>
                                </div>
                            </div>
                        </div>
                        <div id="bm-banned-header" class="bm-panel-header is-secondary-view">
                            <h4 class="bm-panel-title">已封禁列表 (<span id="bm-banned-count">0</span>)</h4>
                            <div class="game-stats-dashboard">
                                <div class="game-stat-item" data-game="gs-character"
                                    style="--game-color: #a7d8f0; --game-text-color: #1c6a97;"><span
                                        class="game-name">原神</span><span class="game-count">0</span></div>
                                <div class="game-stat-item" data-game="sr-character"
                                    style="--game-color: #565656; --game-text-color: #ffffff;"><span
                                        class="game-name">星铁</span><span class="game-count">0</span></div>
                                <div class="game-stat-item" data-game="zzz-character"
                                    style="--game-color: #fe97e7; --game-text-color: #6a3838;"><span
                                        class="game-name">绝区零</span><span class="game-count">0</span></div>
                                <div class="game-stat-item" data-game="waves-character"
                                    style="--game-color: #ffd600; --game-text-color: #383d41;"><span
                                        class="game-name">鸣潮</span><span class="game-count">0</span></div>
                                <div class="game-stat-item" data-game="unknown"
                                    style="--game-color: #e0e0e0; --game-text-color: #616161;"><span
                                        class="game-name">未知</span><span class="game-count">0</span></div>
                            </div>
                        </div>
                        <div id="bm-banned-panel" class="bm-panel is-secondary">
                            <div class="bm-panel-wrapper">
                                <div id="bm-banned-grid" class="bm-image-grid">
                                    <div class="bm-placeholder">
                                        <p>这里将显示所有被封禁的图片</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bm-right-column">
                        <div id="bm-unbanned-header" class="bm-panel-header">
                            <h4 class="bm-panel-title">未封禁列表 (<span id="bm-unbanned-count">0</span>)</h4>
                            <div class="game-stats-dashboard">
                                <div class="game-stat-item" data-game="gs-character"
                                    style="--game-color: #a7d8f0; --game-text-color: #1c6a97;"><span
                                        class="game-name">原神</span><span class="game-count">0</span></div>
                                <div class="game-stat-item" data-game="sr-character"
                                    style="--game-color: #565656; --game-text-color: #ffffff;"><span
                                        class="game-name">星铁</span><span class="game-count">0</span></div>
                                <div class="game-stat-item" data-game="zzz-character"
                                    style="--game-color: #fe97e7; --game-text-color: #6a3838;"><span
                                        class="game-name">绝区零</span><span class="game-count">0</span></div>
                                <div class="game-stat-item" data-game="waves-character"
                                    style="--game-color: #ffd600; --game-text-color: #383d41;"><span
                                        class="game-name">鸣潮</span><span class="game-count">0</span></div>
                                <div class="game-stat-item" data-game="unknown"
                                    style="--game-color: #e0e0e0; --game-text-color: #616161;"><span
                                        class="game-name">未知</span><span class="game-count">0</span></div>
                            </div>
                        </div>
                        <div id="bm-unbanned-panel" class="bm-panel is-primary">
                            <div class="bm-panel-wrapper">
                                <div id="bm-unbanned-grid" class="bm-image-grid">
                                    <div class="bm-placeholder">
                                        <p>根据筛选条件显示图片</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="bm-selection-box" class="bm-selection-box hidden"></div>
                <div id="bm-bulk-action-bar" class="bm-bulk-action-bar hidden">
                    <span id="bm-bulk-action-text">已选择 0 项</span>
                    <div class="bm-bulk-buttons">
                        <button id="bm-bulk-select-all-btn" class="bm-action-btn select-all">全选</button>
                        <button id="bm-bulk-invert-btn" class="bm-action-btn invert">反选</button>
                        <button id="bm-bulk-ban-btn" class="bm-action-btn ban">封禁选中</button>
                        <button id="bm-bulk-unban-btn" class="bm-action-btn unban">解禁选中</button>
                        <button id="bm-bulk-cancel-btn" class="bm-action-btn cancel">取消选择</button>
                    </div>
                </div>
            </div>

            <div id="pluginGalleryPane" class="tab-pane">
                <div class="plugin-content-wrapper">
                    <div class="plugin-left-panel">
                        <div class="form-group">
                            <label for="pluginFolderSearchInput">搜索角色文件夹:</label>
                            <div class="search-input-wrapper">
                                <input type="search" id="pluginFolderSearchInput" class="cartoon-input search-input"
                                    placeholder="输入角色名过滤...">
                            </div>
                        </div>
                        <div id="pluginSourceFilterButtons" class="source-filter-buttons">
                            <button class="source-filter-btn active" data-source="all">全部</button>
                            <button class="source-filter-btn" data-source="miao">Miao</button>
                            <button class="source-filter-btn" data-source="zzz">ZZZ</button>
                            <button class="source-filter-btn" data-source="waves">Waves</button>
                        </div>
                        <div id="pluginFolderListContainer">
                            <p id="pluginFolderLoading" class="no-results">正在加载文件夹...</p>
                            <p id="pluginFolderNoResults" class="no-results hidden">未找到文件夹。</p>
                        </div>
                    </div>
                    <div class="plugin-middle-panel-preview">
                        <div id="pluginImageGridPreviewContainer">
                            <p id="pluginPreviewPlaceholder" class="panel-placeholder">请从左侧选择一个文件夹以查看图片</p>
                            <div id="pluginImageGridPreview" class="hidden"></div>
                        </div>
                        <div id="pluginPaginationControls" class="pagination-controls hidden">
                            <button id="pluginPrevPageBtn" class="pagination-btn">
                                < 上一页</button>
                                    <span id="pluginPageInfo" class="page-info">第 1 / 1 页</span>
                                    <button id="pluginNextPageBtn" class="pagination-btn">下一页 ></button>
                        </div>
                    </div>
                    <div class="plugin-right-panel-editor">
                        <h4 class="panel-title">图片属性 & 编辑</h4>
                        <div id="pluginAttributeInfoArea">
                            <p id="pluginEditorPlaceholder" class="panel-placeholder">请在中间选择一张图片查看属性</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="communityGalleryPane" class="tab-pane">
                <div class="cgp-container">
                    <div class="cgp-left-panel">
                        <div class="cgp-add-section ste-column">
                            <h3 class="column-title">添加新的社区图库</h3>
                            <div class="cgp-input-group">
                                <label for="cgp-repo-url-input">Git 仓库地址</label>
                                <div class="cgp-input-wrapper">
                                    <input type="text" id="cgp-repo-url-input"
                                        placeholder="https://github.com/user/repo">
                                </div>
                            </div>
                            <div class="cgp-input-group">
                                <label for="cgp-repo-alias-input">为图库指定一个简名</label>
                                <div class="cgp-input-row">
                                    <div class="cgp-input-wrapper">
                                        <input type="text" id="cgp-repo-alias-input" placeholder="例如: 云露图库">
                                    </div>
                                    <button id="cgp-add-button">添加</button>
                                </div>
                            </div>
                        </div>
                        <div class="cgp-status-panel">
                            <h4>当前状态</h4>
                            <span id="cgp-status-text">等待操作...</span>
                            <div id="cgp-progress-bar-container">
                                <div id="cgp-progress-bar"></div>
                            </div>
                            <textarea id="cgp-log-output" readonly placeholder="操作日志将显示在这里..."></textarea>
                        </div>
                    </div>
                    <div class="cgp-right-panel">
                        <h3>已安装的图库</h3>
                        <div class="cgp-gallery-grid">
                            <div class="cgp-placeholder" id="cgp-empty-placeholder"
                                style="display: none; grid-column: 1 / -1;">
                                <div class="cgp-placeholder-icon">🎨</div>
                                <p>还没有添加任何社区图库哦！<br>从左侧开始吧。</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="advancedManagementPane" class="tab-pane">
            <div class="adv-mgmt-content">
                <div class="adv-mgmt-section">
                    <h3 class="section-title">数据维护</h3>
                    <div class="tool-grid">
                        <div class="tool-card">
                            <h4>孤立文件查找</h4>
                            <p class="tool-description">查找存在于文件系统但未记录在 JSON 中的图片。</p>
                            <button id="findOrphanedFilesBtn" class="tool-button-adv">开始查找</button>
                            <div class="tool-output hidden">
                                <p>发现 <span id="orphanedCount">0</span> 个孤立文件:</p>
                                <textarea id="orphanedFilesList" readonly placeholder="孤立文件列表..."></textarea>
                                <button id="deleteOrphanedBtn" class="tool-button-adv danger disabled">删除选中
                                    (待实现)</button>
                                <button id="importOrphanedBtn" class="tool-button-adv primary disabled">导入选中
                                    (待实现)</button>
                            </div>
                        </div>
                        <div class="tool-card">
                            <h4>重复文件查找 (基于 MD5)</h4>
                            <p class="tool-description">查找图库中 MD5 值完全相同的图片。</p>
                            <button id="findDuplicateFilesBtn" class="tool-button-adv">开始查找</button>
                            <div class="tool-output hidden">
                                <p>发现 <span id="duplicateSetsCount">0</span> 组重复文件:</p>
                                <div id="duplicateFilesList" class="scrollable-list-adv">重复文件列表...</div>
                                <button id="manageDuplicatesBtn" class="tool-button-adv primary disabled">管理重复项
                                    (待实现)</button>
                            </div>
                        </div>
                        <div class="tool-card">
                            <h4>缩略图缓存管理</h4>
                            <p class="tool-description">清理或重新生成图片缩略图缓存。</p>
                            <p>缓存大小: <span id="thumbnailCacheSize">未知</span></p>
                            <button id="clearThumbnailCacheBtn" class="tool-button-adv danger">清除缓存 (待实现)</button>
                            <button id="regenerateThumbnailCacheBtn" class="tool-button-adv">重新生成 (待实现)</button>
                        </div>
                    </div>
                </div>
                <div class="adv-mgmt-section">
                    <h3 class="section-title">批量操作</h3>
                    <div class="tool-grid">
                        <div class="tool-card">
                            <h4>批量属性编辑</h4>
                            <p class="tool-description">批量修改指定文件夹或图库内图片的属性。</p>
                            <button id="bulkEditAttributesBtn" class="tool-button-adv primary disabled">进入批量编辑
                                (待实现)</button>
                        </div>
                        <div class="tool-card">
                            <h4>文件夹管理</h4>
                            <p class="tool-description">重命名或移动角色文件夹 (高风险!)。</p>
                            <button id="manageFoldersBtn" class="tool-button-adv warning disabled">管理文件夹
                                (待实现)</button>
                        </div>
                    </div>
                </div>
                <div class="adv-mgmt-section">
                    <h3 class="section-title">系统与配置</h3>
                    <div class="tool-grid">
                        <div class="tool-card">
                            <h4>源目录管理</h4>
                            <p class="tool-description">查看和编辑图库扫描的源目录。</p>
                            <button id="manageSourceDirsBtn" class="tool-button-adv disabled">管理源目录 (待实现)</button>
                        </div>
                        <div class="tool-card">
                            <h4>数据备份与恢复</h4>
                            <p class="tool-description">备份或恢复核心 JSON 和配置文件。</p>
                            <button id="backupDataBtn" class="tool-button-adv primary">立即备份 (待实现)</button>
                            <button id="restoreDataBtn" class="tool-button-adv danger">从备份恢复 (待实现)</button>
                        </div>
                        <div class="tool-card">
                            <h4>日志查看器</h4>
                            <p class="tool-description">查看后端服务器运行日志。</p>
                            <button id="viewLogsBtn" class="tool-button-adv disabled">查看日志 (待实现)</button>
                        </div>
                    </div>
                </div>
                <div class="adv-mgmt-section danger-zone">
                    <h3 class="section-title danger">危险操作区域</h3>
                    <div class="tool-grid">
                        <div class="tool-card">
                            <h4>原始 JSON 编辑器</h4>
                            <p class="tool-description">直接编辑 ImageData.json 等文件 (极高风险!)。</p>
                            <button id="editRawJsonBtn" class="tool-button-adv danger disabled">打开编辑器 (待实现)</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div id="toast-container"></div>

    <div id="editAttributeModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h4>修改图片属性</h4>
            <div id="modalFilename" class="modal-filename">文件名: <span></span></div>
            <input type="hidden" id="modalEntryPath">
            <div class="modal-form">
                <div class="modal-group">
                    <label class="modal-group-label">限制级:</label>
                    <div class="options-container">
                        <label><input type="radio" name="modalRating" value="none"> 无</label>
                        <label><input type="radio" name="modalRating" value="px18"> Px18 (轻色情)</label>
                        <label><input type="radio" name="modalRating" value="rx18"> Rx18 (重度色情)</label>
                    </div>
                </div>
                <div class="modal-group">
                    <label class="modal-group-label">构图:</label>
                    <div class="options-container">
                        <label><input type="radio" name="modalLayout" value="normal"> 人像图</label>
                        <label><input type="radio" name="modalLayout" value="fullscreen"> 全屏图</label>
                        <label><input type="radio" name="modalLayout" value="catcake"> [🐱猫猫糕🐱]</label>
                    </div>
                </div>
                <div class="modal-group">
                    <label class="modal-group-label">特殊:</label>
                    <div class="options-container">
                        <label><input type="checkbox" id="modalIsEasterEgg"> 彩蛋</label>
                        <label><input type="checkbox" id="modalIsAiImage"> AI图</label>
                        <label><input type="checkbox" id="modalisBan"> 封禁</label>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="modalSaveButton" class="modal-button modal-save">保存更改</button>
                <button id="modalCancelButton" class="modal-button modal-cancel">取消</button>
            </div>
            <div id="modalMessageArea" class="modal-message"></div>
        </div>
    </div>

    <div id="imageModalOverlay" class="image-modal-overlay hidden">
        <button id="modalCloseButton" class="modal-close-button">×</button>
        <div class="image-modal-content">
            <img id="modalImageViewer" src="" alt="放大的图片">
        </div>
    </div>

    </div>

    <div id="steTagManagementModal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="steModalCloseBtn" class="modal-close-button">×</button>
            <h4>二级标签管理</h4>
            <div class="modal-form dual-column">
                <div class="modal-column">
                    <div class="modal-form-section">
                        <h5>添加到现有分类</h5>
                        <div class="modal-form-group">
                            <label for="steModalCategorySelect">选择分类:</label>
                            <select id="steModalCategorySelect" class="cartoon-select"></select>
                        </div>
                        <div class="modal-form-group">
                            <label for="steModalNewTagInput">新标签名 (多个用逗号隔开):</label>
                            <input type="text" id="steModalNewTagInput" class="cartoon-input" placeholder="例如: 旗袍, 泳装">
                        </div>
                        <button id="steModalAddNewTagBtn" class="tool-button-adv primary">添加标签</button>
                    </div>
                    <div class="modal-form-section">
                        <h5>新增一个分类</h5>
                        <div class="modal-form-group">
                            <label for="steModalNewCategoryInput">新分类名 (含Emoji):</label>
                            <input type="text" id="steModalNewCategoryInput" class="cartoon-input"
                                placeholder="例如: 🚀 载具">
                        </div>
                        <div class="modal-form-group">
                            <label for="steModalFirstTagInput">该分类下的第一个标签:</label>
                            <input type="text" id="steModalFirstTagInput" class="cartoon-input" placeholder="例如: 飞船">
                        </div>
                        <button id="steModalAddNewCategoryBtn" class="tool-button-adv primary">新增分类和标签</button>
                    </div>
                </div>
                <div class="modal-column">
                    <div class="modal-form-section delete-section">
                        <h5>删除标签 (点击标签上的 "×" 可移除)</h5>
                        <div id="tagsToDeleteContainer" class="tags-to-delete-container">
                            <p>正在加载标签...</p>
                        </div>
                        <button id="steModalSaveChangesBtn" class="tool-button-adv primary">保存更改</button>
                    </div>
                </div>
            </div>
            <div id="steModalMessageArea" class="modal-message"></div>
        </div>
    </div>

    <div id="cgpCustomConfirmModal" class="modal-overlay hidden">
        <div class="modal-content cgp-modal-content">
            <h4 id="cgpModalTitle">确认操作</h4>
            <p id="cgpModalMessage">确定要执行此操作吗？</p>
            <div class="modal-actions cgp-modal-actions">
                <button id="cgpModalConfirmBtn" class="modal-button modal-save">确认</button>
                <button id="cgpModalCancelBtn" class="modal-button modal-cancel">取消</button>
            </div>
        </div>
    </div>

    <div id="cgpSpeedTestFloater" class="cgp-floater hidden">
        <div class="cgp-floater-header">
            <span>正在进行网络节点测速...</span>
            <button id="cgpFloaterCloseBtn" class="cgp-floater-close">×</button>
        </div>
        <div id="cgpSpeedTestResults" class="cgp-floater-content"></div>
    </div>

    <script src="src/Ui_Controls.js"></script>
    <script src="src/Home.js"></script>
    <script src="src/Data_List.js"></script>
    <script src="src/Ban_Management.js"></script>
    <script src="src/Community_Gallery.js"></script>
    <script src="src/Plugin_Gallery.js"></script>
    <script src="src/Gu_Tools/GuTools_Main.js"></script>
    <script src="src/Gu_Tools/GuTools_Generator.js"></script>
    <script src="src/Gu_Tools/GuTools_Import.js"></script>
    <script src="src/Gu_Tools/GuTools_MD5.js"></script>
    <script src="src/Gu_Tools/GuTools_Sequence.js"></script>
    <script src="src/Gu_Tools/GuTools_JsonCal.js"></script>
    <script src="src/Gu_Tools/GuTools_StockroomGo.js"></script>
    <script src="src/Gu_Tools/GuTools_StorageboxCal.js"></script>
    <script src="src/Gu_Tools/GuTools_FileSize.js"></script>
    <script src="src/Gu_Tools/GuTools_SecondaryTagEditor.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pinyin-pro@3.27.0/dist/index.min.js"></script>
    <script src="src/Core.js"></script>
</body>

</html>